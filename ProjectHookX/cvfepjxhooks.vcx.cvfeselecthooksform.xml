<?xml version = "1.0" encoding="Windows-1252" standalone="yes"?>
<VFPData>
	<xsd:schema id="VFPData" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
		<xsd:element name="VFPData" msdata:IsDataSet="true">
			<xsd:complexType>
				<xsd:choice maxOccurs="unbounded">
					<xsd:element name="class" minOccurs="0" maxOccurs="unbounded">
						<xsd:complexType>
							<xsd:sequence>
								<xsd:element name="platform">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="8"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="uniqueid">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="10"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="class">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="classloc">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="baseclass">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="objname">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="parent">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="properties">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="protected">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="methods">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="ole">
									<xsd:simpleType>
										<xsd:restriction base="xsd:base64Binary">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="ole2">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="reserved1">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="reserved2">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="reserved3">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="reserved4">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="reserved5">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="reserved6">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="reserved7">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="reserved8">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="user">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
							</xsd:sequence>
						</xsd:complexType>
					</xsd:element>
				</xsd:choice>
				<xsd:anyAttribute namespace="http://www.w3.org/XML/1998/namespace" processContents="lax"/>
			</xsd:complexType>
		</xsd:element>
	</xsd:schema>
	<class>
		<platform>WINDOWS</platform>
		<uniqueid>_RUJ11X56I</uniqueid>
		<class><![CDATA[frmselecthooks]]></class>
		<classloc><![CDATA[pjxhookx.vcx]]></classloc>
		<baseclass><![CDATA[form]]></baseclass>
		<objname><![CDATA[cvfeselecthooksform]]></objname>
		<parent/>
		<properties><![CDATA[DoCreate = .T.
Name = "cvfeselecthooksform"
lstHooks.Name = "lstHooks"
cmdAddHook.Name = "cmdAddHook"
cmdRemoveHook.Name = "cmdRemoveHook"
cmdok.Name = "cmdok"
cmdcancel.Name = "cmdcancel"
]]></properties>
		<protected/>
		<methods><![CDATA[PROCEDURE addvferecord
This.SetBuffer()

INSERT INTO (ThisForm.cHookAlias) ;
	(cPjxName, mHookName, mHookLib, nOrder) ;
VALUES ;
	(ThisForm.cPjxName, "cVFEPJXHook", This.RelPath(This.ClassLibrary, This.oProject.Name), 1)

=TABLEUPDATE(1)

IF NOT This.nOldBuffer = CURSORGETPROP("Buffering")
	=CURSORSETPROP("Buffering", This.nOldBuffer)
ENDIF	

IF NOT This.cOldMultiLocks = SET("MULTILOCKS")
	lcOldMultiLocks = This.cOldMultiLocks
	SET MULTILOCKS &lcOldMultiLocks
ENDIF


ENDPROC
PROCEDURE Init
LPARAMETERS ;
	tcPjxName, ;
	toCalling
	
LOCAL ;
	lnSelect, ;
	lnRecords, ;
	lnHoldRecno

IF PCOUNT() < 2 OR ;
	VARTYPE(tcPjxName) <> T_CHARACTER OR ;
	EMPTY(tcPjxName) OR ;
	VARTYPE(toCalling) <> T_OBJECT OR ;
	TYPE("toCalling.cHookAlias") <> T_CHARACTER OR ;
	TYPE("toCalling.lHooksTableOpen") <> T_LOGICAL OR ;
	NOT toCalling.lHooksTableOpen

	=MESSAGEBOX( ;
		INVALID_CALL_TO_SELECTHOOKS, ;
		MB_OK + MB_ICONINFORMATION, ;
		_Screen.Caption)
	RETURN .F.
ENDIF

tcPjxName = UPPER(ALLTRIM(tcPjxName))
This.cHookAlias = toCalling.cHookAlias	
This.oProject = toCalling.oProject
lnSelect = SELECT()
SELECT (This.cHookAlias)
lnHoldRecno = RECNO()
This.cPjxName = tcPjxName
COUNT TO lnRecords FOR UPPER(ALLTRIM(cPjxName)) = This.cPjxName AND NOT DELETED()

IF TYPE("oVFE.Name") = "C" AND lnRecords = 0
	This.AddVFERecord()
	SELECT (lnSelect)
	RETURN .F.
ELSE
	
	IF lnRecords > 0
		GO (lnHoldRecno)
	ENDIF
	
	SELECT (lnSelect)
	DODEFAULT(tcPjxName, toCalling)
ENDIF		

ENDPROC
]]></methods>
		<ole/>
		<ole2/>
		<reserved1><![CDATA[Class]]></reserved1>
		<reserved2><![CDATA[1]]></reserved2>
		<reserved3><![CDATA[*addvferecord Manually add the VFE record to the project hooks table.
]]></reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6><![CDATA[Pixels]]></reserved6>
		<reserved7/>
		<reserved8><![CDATA[pjxhookx.h]]></reserved8>
		<user/>
	</class>
	<class>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<class/>
		<classloc/>
		<baseclass/>
		<objname><![CDATA[cvfeselecthooksform]]></objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</class>
</VFPData>
