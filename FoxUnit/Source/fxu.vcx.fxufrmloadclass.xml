<?xml version = "1.0" encoding="Windows-1252" standalone="yes"?>
<VFPData>
	<xsd:schema id="VFPData" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
		<xsd:element name="VFPData" msdata:IsDataSet="true">
			<xsd:complexType>
				<xsd:choice maxOccurs="unbounded">
					<xsd:element name="class" minOccurs="0" maxOccurs="unbounded">
						<xsd:complexType>
							<xsd:sequence>
								<xsd:element name="platform">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="8"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="uniqueid">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="10"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="class">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="classloc">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="baseclass">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="objname">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="parent">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="properties">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="protected">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="methods">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="ole">
									<xsd:simpleType>
										<xsd:restriction base="xsd:base64Binary">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="ole2">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="reserved1">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="reserved2">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="reserved3">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="reserved4">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="reserved5">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="reserved6">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="reserved7">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="reserved8">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="user">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="nrecno">
									<xsd:simpleType>
										<xsd:restriction base="xsd:decimal">
											<xsd:totalDigits value="10"/>
											<xsd:fractionDigits value="0"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
							</xsd:sequence>
						</xsd:complexType>
					</xsd:element>
				</xsd:choice>
				<xsd:anyAttribute namespace="http://www.w3.org/XML/1998/namespace" processContents="lax"/>
			</xsd:complexType>
		</xsd:element>
	</xsd:schema>
	<class>
		<platform>WINDOWS</platform>
		<uniqueid/>
		<class><![CDATA[fxufrmbase]]></class>
		<classloc><![CDATA[fxu.vcx]]></classloc>
		<baseclass><![CDATA[form]]></baseclass>
		<objname><![CDATA[fxufrmloadclass]]></objname>
		<parent/>
		<properties><![CDATA[Height = 397
Width = 760
DoCreate = .T.
AutoCenter = .T.
Caption = "Load Class"
ControlBox = .T.
Closable = .F.
MaxButton = .F.
MinButton = .F.
Icon = ..\graphics\foxunit.ico
WindowType = 1
icfxudefaulttestdirectory = .F.
icfxuselectedtestdirectory = 
ilcancel = .F.
_memberdata = <VFPData></VFPData>
Name = "fxufrmloadclass"
]]></properties>
		<protected><![CDATA[icfxudefaulttestdirectory
]]></protected>
		<methods><![CDATA[PROCEDURE cancelaction
thisform.ilCancel = .T.
thisform.Hide()


ENDPROC
PROCEDURE gettestcases
LOCAL llFXUinSetProcedure, lnPrgCount

LOCAL ARRAY laTestCases[1]
LOCAL ARRAY laOldTestCases[1]

llFXUinSetProcedure = 'FXU.PRG' $ SET("Procedure")

IF NOT llFXUinSetProcedure
  SET PROCEDURE TO FXU.PRG ADDITIVE 
ENDIF 

ThisForm.SetTestCasesOnlyState() 

* fxuresults is the GOD cursor. HAS
SELECT distinct tclass FROM fxuresults INTO ARRAY laOldTestCases

WITH thisform 
  DO CASE 
    CASE .chkNewTestCases.value AND .chkTestCasesOnly.value
      *
      * List only New Test Cases
      *
      lnPrgCount = getArrayOfNewTestCases(@laTestCases, @laOldTestCases, ThisForm.icFxuSelectedTestDirectory)
    CASE .ChkTestCasesOnly.value
      *
      * List only Test Cases
      *
      lnPrgCount = getArrayOfTestCases(@laTestCases, ThisForm.icFxuSelectedTestDirectory)
    CASE .chkNewTestCases.value
      *
      * List only New Programs
      *
      lnPrgCount = getArrayOfNewProgramFiles(@laTestCases, @laOldTestCases, ThisForm.icFxuSelectedTestDirectory)    
    OTHERWISE 
      *
      * List All Programs
      *
      lnPrgCount = getArrayOfProgramFiles(@laTestCases,ThisForm.icFxuSelectedTestDirectory)
  ENDCASE 

  DIMENSION .iafiles[1]
 
  *BUG If there is only one test class prg in the directory,
  * this line would cause FoxUnit to ignore it. HAS
  *IF ALEN(laTestCases,1) > 1 AND ;
      TYPE('laTestCases[1,1]') = 'C'
  IF ALEN(laTestCases,1) > 0 AND ;
      TYPE('laTestCases[1,1]') = 'C'

    ACOPY(laTestCases, .iaFiles)
 
    .cmdLoad.Enabled = .T.  

  ELSE 
 
    .iaFiles[1] = "No Test Cases Found"
    .cmdLoad.Enabled = .F.  
 
  ENDIF   

ENDWITH

thisform.lstFiles.Requery()

RELEASE laOldTestCases

RELEASE laTestCases

IF NOT llFXUinSetProcedure

  TRY 
    RELEASE PROCEDURE FXU
  CATCH TO oException
  ENDTRY
  
ENDIF 

ENDPROC
PROCEDURE Init
LPARAMETERS tcDataPath

Thisform.MinHeight	= thisform.Height	&& FDBOZZO
thisform.MinWidth	= thisform.Width	&& FDBOZZO

*FIXME I still don't understand why we always look here.   Doesn't anybody else
* store their tests with the project in version control? 
* Why not use the current value of SET DEFAULT, at least? HAS
thisform.icFxuDefaultTestDirectory = EVL( tcDataPath, ADDBS(JUSTPATH(FULLPATH("FXUResults.DBF"))) )

thisform.icFxuSelectedTestDirectory = thisform.icFxuDefaultTestDirectory

thisform.getTestCases()

ENDPROC
PROCEDURE okaction
thisform.ilCancel = .F.
thisform.Hide()

ENDPROC
PROCEDURE selectall
LPARAMETERS tlSelect

LOCAL lnX

IF EMPTY(tlSelect)
	tlSelect = .f.
ELSE
	tlSelect = .t.
ENDIF

FOR lnX = 1 TO ThisForm.lstFiles.ListCount

	ThisForm.lstFiles.Selected(lnX) = tlSelect

ENDFOR
ENDPROC
PROCEDURE selectalternatetestfolder
LOCAL lcSelectedTestDirectory

lcSelectedTestDirectory = GETDIR(this.icFxuDefaultTestDirectory, "Select Test Folder", "Select Test Folder", 1+2+8+16+32+64) && Added nFlags parameter. HAS

IF DIRECTORY(lcSelectedTestDirectory)
	
	ThisForm.icFxuSelectedTestDirectory = lcSelectedTestDirectory

	this.GetTestCases()

ENDIF 
ENDPROC
PROCEDURE settestcasesonlystate
IF !UPPER( ThisForm.icFxuSelectedTestDirectory ) == UPPER( this.icFxuDefaultTestDirectory )

	ThisForm.chkTestCasesOnly.Value = .t.
	ThisForm.chkTestCasesOnly.Enabled = .f.
	
ELSE

	ThisForm.chkTestCasesOnly.Enabled = .t.
	
ENDIF 

ThisForm.chkTestCasesOnly.Refresh()
ENDPROC
]]></methods>
		<ole/>
		<ole2/>
		<reserved1><![CDATA[Class]]></reserved1>
		<reserved2><![CDATA[9]]></reserved2>
		<reserved3><![CDATA[icfxudefaulttestdirectory
icfxuselectedtestdirectory
ilcancel
_memberdata XML Metadata for customizable properties
^iafiles[1,0] 
*cancelaction 
*gettestcases 
*okaction 
*selectall 
*selectalternatetestfolder 
*settestcasesonlystate 
]]></reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6><![CDATA[Pixels]]></reserved6>
		<reserved7/>
		<reserved8/>
		<user/>
		<nrecno>97</nrecno>
	</class>
	<class>
		<platform>WINDOWS</platform>
		<uniqueid/>
		<class><![CDATA[checkbox]]></class>
		<classloc/>
		<baseclass><![CDATA[checkbox]]></baseclass>
		<objname><![CDATA[chkNewTestCases]]></objname>
		<parent><![CDATA[fxufrmloadclass]]></parent>
		<properties><![CDATA[Top = 375
Left = 8
Height = 17
Width = 116
Alignment = 0
Caption = "New Test Cases"
Value = .T.
ToolTipText = "Only list test cases that are not already in FoxUnit."
Name = "chkNewTestCases"
]]></properties>
		<protected/>
		<methods><![CDATA[PROCEDURE Click
thisform.getTestCases()
ENDPROC
]]></methods>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
		<nrecno>102</nrecno>
	</class>
	<class>
		<platform>WINDOWS</platform>
		<uniqueid/>
		<class><![CDATA[checkbox]]></class>
		<classloc/>
		<baseclass><![CDATA[checkbox]]></baseclass>
		<objname><![CDATA[chkTestCasesOnly]]></objname>
		<parent><![CDATA[fxufrmloadclass]]></parent>
		<properties><![CDATA[Top = 354
Left = 8
Height = 17
Width = 112
Alignment = 0
Caption = "Test Cases Only"
Value = .T.
ToolTipText = "Only list programs that are a test case class."
Name = "chkTestCasesOnly"
]]></properties>
		<protected/>
		<methods><![CDATA[PROCEDURE Click
thisform.getTestCases()
ENDPROC
]]></methods>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
		<nrecno>101</nrecno>
	</class>
	<class>
		<platform>WINDOWS</platform>
		<uniqueid/>
		<class><![CDATA[commandbutton]]></class>
		<classloc/>
		<baseclass><![CDATA[commandbutton]]></baseclass>
		<objname><![CDATA[cmdBrowse]]></objname>
		<parent><![CDATA[fxufrmloadclass]]></parent>
		<properties><![CDATA[Top = 171
Left = 665
Height = 48
Width = 84
Picture = ..\graphics\fxubrowseforfolder.bmp
Caption = "\<Browse"
Default = .F.
Name = "cmdBrowse"
]]></properties>
		<protected/>
		<methods><![CDATA[PROCEDURE Click
ThisForm.SelectAlternateTestFolder()

ENDPROC
]]></methods>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
		<nrecno>103</nrecno>
	</class>
	<class>
		<platform>WINDOWS</platform>
		<uniqueid/>
		<class><![CDATA[commandbutton]]></class>
		<classloc/>
		<baseclass><![CDATA[commandbutton]]></baseclass>
		<objname><![CDATA[cmdCancel]]></objname>
		<parent><![CDATA[fxufrmloadclass]]></parent>
		<properties><![CDATA[Top = 297
Left = 665
Height = 48
Width = 84
Picture = ('fxucancel.bmp')
Cancel = .T.
Caption = "\<Cancel"
Name = "cmdCancel"
]]></properties>
		<protected/>
		<methods><![CDATA[PROCEDURE Click
thisform.cancelaction()
ENDPROC
]]></methods>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
		<nrecno>100</nrecno>
	</class>
	<class>
		<platform>WINDOWS</platform>
		<uniqueid/>
		<class><![CDATA[commandbutton]]></class>
		<classloc/>
		<baseclass><![CDATA[commandbutton]]></baseclass>
		<objname><![CDATA[cmdDeselectAll]]></objname>
		<parent><![CDATA[fxufrmloadclass]]></parent>
		<properties><![CDATA[Top = 108
Left = 666
Height = 48
Width = 84
Picture = ..\graphics\fxuselectnone.bmp
Caption = "\<Deselect All"
Default = .F.
Name = "cmdDeselectAll"
]]></properties>
		<protected/>
		<methods><![CDATA[PROCEDURE Click
ThisForm.SelectAll(.f.)
ENDPROC
]]></methods>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
		<nrecno>104</nrecno>
	</class>
	<class>
		<platform>WINDOWS</platform>
		<uniqueid/>
		<class><![CDATA[commandbutton]]></class>
		<classloc/>
		<baseclass><![CDATA[commandbutton]]></baseclass>
		<objname><![CDATA[cmdLoad]]></objname>
		<parent><![CDATA[fxufrmloadclass]]></parent>
		<properties><![CDATA[Top = 236
Left = 665
Height = 48
Width = 84
Picture = ..\graphics\fxuclassload.bmp
Caption = "\<Load"
Default = .F.
Name = "cmdLoad"
]]></properties>
		<protected/>
		<methods><![CDATA[PROCEDURE Click
thisform.okAction()

ENDPROC
]]></methods>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
		<nrecno>99</nrecno>
	</class>
	<class>
		<platform>WINDOWS</platform>
		<uniqueid/>
		<class><![CDATA[commandbutton]]></class>
		<classloc/>
		<baseclass><![CDATA[commandbutton]]></baseclass>
		<objname><![CDATA[cmdSelectAll]]></objname>
		<parent><![CDATA[fxufrmloadclass]]></parent>
		<properties><![CDATA[Top = 48
Left = 668
Height = 48
Width = 84
Picture = ..\graphics\fxuselectall.bmp
Caption = "\<Select All"
Default = .T.
Name = "cmdSelectAll"
]]></properties>
		<protected/>
		<methods><![CDATA[PROCEDURE Click
thisform.SelectAll(.t.)
ENDPROC
]]></methods>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
		<nrecno>105</nrecno>
	</class>
	<class>
		<platform>WINDOWS</platform>
		<uniqueid/>
		<class><![CDATA[listbox]]></class>
		<classloc/>
		<baseclass><![CDATA[listbox]]></baseclass>
		<objname><![CDATA[lstFiles]]></objname>
		<parent><![CDATA[fxufrmloadclass]]></parent>
		<properties><![CDATA[RowSourceType = 5
RowSource = "thisform.iaFiles"
Height = 333
Left = 8
MultiSelect = .T.
Top = 12
Width = 648
Name = "lstFiles"
]]></properties>
		<protected/>
		<methods><![CDATA[PROCEDURE DblClick
thisform.OkAction()
ENDPROC
]]></methods>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
		<nrecno>98</nrecno>
	</class>
	<class>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<class/>
		<classloc/>
		<baseclass/>
		<objname><![CDATA[fxufrmloadclass]]></objname>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
		<nrecno>106</nrecno>
	</class>
</VFPData>
